(()=>{console.log("[Mindful Timer] Content script loaded.");const e=document.createElement("div");e.id="mindful-timer-overlay",e.style.all="initial",e.style.fontFamily="sans-serif",e.style.position="fixed",e.style.bottom="20px",e.style.right="20px",e.style.width="150px",e.style.height="auto",e.style.background="rgba(0, 0, 0, 0.7)",e.style.color="#fff",e.style.borderRadius="8px",e.style.padding="10px",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="center",e.style.justifyContent="center",e.style.fontSize="14px",e.style.zIndex="999999",e.style.userSelect="none",chrome.runtime.onMessage.addListener((i,n,l)=>{console.log("Content script received message:",i),l({ack:!0})});const o=document.createElement("div");o.style.all="unset",o.style.fontSize="18px",o.style.fontWeight="bold",o.style.color="#fff",e.appendChild(o);const s=document.createElement("button");s.textContent="Ã—",s.style.all="unset",s.style.position="absolute",s.style.top="5px",s.style.right="8px",s.style.background="transparent",s.style.color="#fff",s.style.border="none",s.style.cursor="pointer",s.style.fontSize="16px",e.appendChild(s),s.addEventListener("click",()=>{e.remove()}),document.body.appendChild(e);function a(i){const n=Math.floor(i/60).toString().padStart(2,"0"),l=(i%60).toString().padStart(2,"0");return`${n}:${l}`}function r(){chrome.storage.sync.get("timerState",i=>{const n=i.timerState;if(n&&n.isActive)if(n.isPaused)o.textContent="Paused";else if(n.endTime){const l=Date.now(),c=n.endTime-l,d=Math.max(0,Math.floor(c/1e3));o.textContent=a(d)}else o.textContent="No timer running";else o.textContent="No timer running";n!=null&&n.isActive?(t.disabled=!1,t.textContent=n.isPaused?"Resume":"Pause"):(t.textContent="Pause",t.disabled=!0)})}const t=document.createElement("button");t.style.all="unset",t.style.display="inline-block",t.textContent="Pause",t.style.cursor="pointer",t.style.fontSize="14px",t.style.padding="6px 10px",t.style.marginTop="5px",t.style.color="#333",t.style.background="#ccc",t.style.border="1px solid #666",t.style.borderRadius="4px",e.appendChild(t),t.addEventListener("click",()=>{chrome.storage.sync.get("timerState",i=>{const n=i.timerState;n&&n.isActive&&(n.isPaused?chrome.runtime.sendMessage({action:"resumeTimer"}):chrome.runtime.sendMessage({action:"pauseTimer"}))})}),setInterval(r,1e3),r()})();
